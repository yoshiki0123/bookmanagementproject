{% load static %}
<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Book Management</title>

    <!-- Bootstrap CSSï¼ˆæ¨™æº–è‰²ã®ã¾ã¾ï¼‰ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    {% block customcss %}{% endblock customcss %}

    <style>
      /* å…¨ä½“ã¯ç™½ãƒ™ãƒ¼ã‚¹ï¼‹è–„ã„ã‚°ãƒ¬ãƒ¼ã®åŒºåˆ‡ã‚Šã®ã¿ */
      body{
        font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Helvetica Neue", Arial, sans-serif;
        letter-spacing: .02em;
        background-color: #f8f9fa; /* Bootstrapã®æ·¡ã„ã‚°ãƒ¬ãƒ¼ */
      }
      /* ã‚·ãƒ³ãƒ—ãƒ«ãªãƒŠãƒ“ãƒãƒ¼ï¼šç™½èƒŒæ™¯ï¼‹ãƒœãƒ¼ãƒ€ãƒ¼ï¼‹å°ã•ãªå½± */
      .navbar-clean{
        background-color: #ffffff;
        border-bottom: 1px solid #e9ecef;
      }
      /* ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒªãƒ³ã‚¯ã¯ä¸‹ç·šã§å¼·èª¿ï¼ˆè‰²ã¯Bootstrapã®primaryï¼‰ */
      .navbar .nav-link.active{
        font-weight: 600;
        position: relative;
      }
      .navbar .nav-link.active::after{
        content:"";
        position: absolute; left: .5rem; right: .5rem; bottom: .35rem;
        height: 2px; border-radius: 2px;
        background-color: var(--bs-primary);
      }
      /* ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ã¯è–„ã„å¸¯ï¼‹ä¸‹ãƒœãƒ¼ãƒ€ãƒ¼ã®ã¿ */
      .page-header{
        background-color: #f8f9fa;
        border-bottom: 1px solid #e9ecef;
      }
      /* ãƒˆãƒ¼ã‚¹ãƒˆï¼šå³ä¸Šã«é‡ã­ã‚‹ã ã‘ï¼ˆè‰²ã¯Bootstrapä»»ã›ï¼‰ */
      .toast-stack{
        position: fixed; top: 1rem; right: 1rem; z-index: 1080;
      }
      /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒˆãƒƒãƒ—ï¼ˆå¿…è¦ãªã‚‰æ´»ç”¨ã€è‰²ã¯æ¨™æº–ï¼‰ */
      #scrollTopBtn{
        position: fixed; right: 1.25rem; bottom: 1.25rem; display: none; z-index: 1080;
      }
    </style>
  </head>

  <body>
    <!-- Stickyï¼ˆå›ºå®šï¼‰ãƒŠãƒ“ãƒãƒ¼ï¼šã‚·ãƒ³ãƒ—ãƒ«ãªç™½ï¼‹ãƒœãƒ¼ãƒ€ãƒ¼ -->
    <nav class="navbar navbar-expand-lg navbar-clean sticky-top shadow-sm">
      <div class="container-fluid">
        <a class="navbar-brand fw-semibold" href="{% url 'bookmanagement:home' %}">
          é‡åŸç ”ç©¶å®¤ å›³æ›¸ç®¡ç†ã‚¢ãƒ—ãƒª
        </a>

        <div class="d-flex align-items-center gap-3 order-lg-2">
          {% if user.is_authenticated %}
            <span class="navbar-text small text-nowrap">
              ã‚ˆã†ã“ãã€<strong>{{ user.get_full_name|default:user.username }}</strong> ã•ã‚“
            </span>
          {% endif %}
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                  aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>

        <div class="collapse navbar-collapse order-lg-1" id="navbarNav">
          {% with url_name=request.resolver_match.url_name %}
          <ul class="navbar-nav ms-lg-4">
            <li class="nav-item">
              <a class="nav-link {% if url_name == 'home' %}active{% endif %}" href="{% url 'bookmanagement:home' %}">ğŸ  ãƒ›ãƒ¼ãƒ </a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if url_name == 'borrow' %}active{% endif %}" href="{% url 'bookmanagement:borrow' %}">ğŸ“¤ æ›¸ç±è²¸å‡º</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if url_name == 'return' %}active{% endif %}" href="{% url 'bookmanagement:return' %}">ğŸ”„ æ›¸ç±è¿”å´</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if url_name == 'book_list' %}active{% endif %}" href="{% url 'bookmanagement:book_list' %}">ğŸ“š æ›¸ç±ä¸€è¦§</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if url_name == 'add_book' %}active{% endif %}" href="{% url 'bookmanagement:add_book' %}">ğŸ“ æ›¸ç±ç™»éŒ²</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if url_name == 'loan_status' %}active{% endif %}" href="{% url 'bookmanagement:loan_status' %}">ğŸ“– è²¸å‡ºçŠ¶æ³</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if url_name == 'logout' %}active{% endif %}" href="{% url 'bookmanagement:logout' %}">ğŸšª ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
            </li>
          </ul>
          {% endwith %}
        </div>
      </div>
    </nav>

    <!-- ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ï¼ˆå„ãƒšãƒ¼ã‚¸ã®è¦‹å‡ºã—ã‚’ã“ã“ã«ï¼‰ -->
    <header class="page-header">
      <div class="container py-3">
        {% block header %}{% endblock header %}
      </div>
    </header>

    <!-- Django messages ã‚’ãƒˆãƒ¼ã‚¹ãƒˆã§è¡¨ç¤ºï¼ˆä»»æ„ï¼‰ -->
    {% if messages %}
    <div class="toast-stack">
      {% for message in messages %}
        {% with tag=message.tags %}
        <div class="toast align-items-center text-bg-{% if tag == 'error' %}danger{% else %}{{ tag|default:'secondary' }}{% endif %} border-0 mb-2"
             role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000">
          <div class="d-flex">
            <div class="toast-body">{{ message }}</div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto"
                    data-bs-dismiss="toast" aria-label="Close"></button>
          </div>
        </div>
        {% endwith %}
      {% endfor %}
    </div>
    {% endif %}

    <!-- ãƒ¡ã‚¤ãƒ³ -->
    <main class="container py-4">
      {% block content %}{% endblock content %}
    </main>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆå¿…è¦æœ€ä½é™ï¼‰ -->
    <footer class="border-top py-4">
      <div class="container small d-flex justify-content-between flex-wrap gap-2 text-muted">
        <span>&copy; {{ now|default:None|date:"Y" }} Nohara Lab Library App</span>
        <span>v1.0</span>
      </div>
    </footer>

    <!-- Scroll to topï¼ˆä»»æ„ï¼‰ -->
    <button id="scrollTopBtn" class="btn btn-primary rounded-circle">
      â†‘
    </button>

    <!-- jQueryï¼ˆå¿…è¦ãªã‚‰ï¼‰ -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <!-- Bootstrap Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <!-- å…±é€šJS -->
    <script src="{% static 'js/common.js' %}"></script>

    <script>
      // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒˆãƒƒãƒ—ï¼ˆå¿…è¦ãªã‘ã‚Œã°å‰Šé™¤OKï¼‰
      (function(){
        const btn = document.getElementById('scrollTopBtn');
        window.addEventListener('scroll', () => {
          btn.style.display = (window.scrollY > 300) ? 'inline-flex' : 'none';
        });
        btn.addEventListener('click', () => window.scrollTo({top: 0, behavior: 'smooth'}));
      })();
    </script>

    {% block customscript %}{% endblock customscript %}
  </body>
</html>
